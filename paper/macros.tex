% Theorems
\theoremstyle{plain} % default
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\crefname{proof}{Proof}{Proofs}

\theoremstyle{definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{definition}[theorem]{Definition}

% Abbrev
\newcommand\eg{\emph{e.g.}\ }
\newcommand\etc{\emph{etc.}}

% Comments and notes
\newcommand{\slpj}[1]{\emph{SLPJ: #1}}
\newenvironment{slpjenv}{\em SLPJ:}{}
\newcommand{\sg}[1]{\emph{SG: #1}}
\newcommand{\todo}[1]{\textcolor{red}{TODO: #1}}

% Auxiliary
\newcommand{\many}[1]{\overline{#1}}
\newcommand{\wild}{\ensuremath{\mathunderscore}}
\newcommand{\pfun}{\rightharpoonup}
\newcommand{\ruleform}[1]{\fbox{$#1$}}
\newcommand{\highlight}[1]{\setlength{\fboxsep}{2pt}\colorbox[gray]{0.8}{\ensuremath{#1}}}
\newcommand{\nelems}[1]{\lvert#1\rvert}
\newcommand{\fn}[2]{\ensuremath{λ#1.\ #2}}
\newcommand{\constfn}[1]{\fn{\mathunderscore}{#1}}
%\newcommand{\repeat}[2]{\foreach \n in {1,...,#1}{#2}} % https://tex.stackexchange.com/a/16190/52414
% https://tex.stackexchange.com/a/21647
\makeatletter
\newcommand{\superimpose}[3][\mathord]{#1{\mathpalette\superimpose@{{#2}{#3}}}}
\newcommand{\superimpose@}[2]{\superimpose@@{#1}#2}
\newcommand{\superimpose@@}[3]{%
  \ooalign{%
    \hfil$\m@th#1#2$\hfil\cr
    \hfil$\m@th#1#3$\hfil\cr
  }%
}
\newenvironment{letarray}{\begin{array}{@{}l@{\hspace{1ex}}l}}{\end{array}}

% Syntax
%% LC
\newcommand{\Con}{\mathsf{Con}}
\newcommand{\Var}{\mathsf{Var}}
\newcommand{\Lab}{\mathsf{Lab}}
\newcommand{\Exp}{\mathsf{Exp}}
\newcommand{\Val}{\mathsf{Val}}
\newcommand{\px}{\mathsf{x}}
\newcommand{\py}{\mathsf{y}}
\newcommand{\pz}{\mathsf{z}}
\newcommand{\pv}{\mathsf{v}}
\newcommand{\pe}{\mathsf{e}}
\newcommand{\Lam}[2]{\lambda #1. #2}
\newcommand{\LLam}[3]{\lambda_{#1} #2. #3}
\newcommand{\Let}[3]{\mathbf{let}~{#1}={#2}~\mathbf{in}~{#3}}
\newcommand{\LLet}[4]{\mathbf{let}_{#1}~{#2}={#3}~\mathbf{in}~{#4}}
\newcommand{\Case}[2]{\mathbf{case}~{#1}~\mathbf{of}~{#2}}
\newcommand{\Sel}[1][]{\many{K~\many{x} \rightarrow e_{#1}}}
\newcommand{\dom}{\mathop\mathsf{dom}}
\newcommand{\rng}{\mathop\mathsf{rng}}
\newcommand{\fv}{\mathop\mathsf{fv}}
\newcommand{\bv}{\mathop\mathsf{bv}}
\newcommand{\fresh}[2]{#1\mathbin{\#}#2}
\newcommand{\delvar}[1]{{\setminus_{#1}}}
%% Actions
\newcommand{\Actions}{\mathbb{A}}
\newcommand{\ValA}{\mathsf{val}}
\newcommand{\BindA}{\mathsf{bind}}
\newcommand{\LookupA}{\mathsf{look}}
\newcommand{\UpdateA}{\mathsf{upd}}
\newcommand{\AppIA}{\mathsf{app}_1}
\newcommand{\AppEA}{\mathsf{app}_2}
\newcommand{\CaseIA}{\mathsf{case}_1}
\newcommand{\CaseEA}{\mathsf{case}_2}
%% Labels
\newcommand{\Labels}{\mathbb{L}}
\newcommand{\lbl}{\ensuremath{\ell}}
\newcommand{\lbln}[1]{\ensuremath{\ell_{#1}}}
\newcommand{\slbl}{\raisebox{0.08em}{$\;\scriptstyle{\ell}\;$}}
\newcommand{\slbln}[1]{\raisebox{0.1em}{$\;\scriptstyle{\ell_{#1}}\;$}}
\newcommand{\atlbl}[1]{at(#1)}
\newcommand{\deref}[1]{*#1}
%% Traces
\newcommand{\Traces}{\mathbb{T}}
\newcommand{\act}[1]{\xrightarrow{#1}}
% https://latex.org/forum/viewtopic.php?p=62177&sid=26890ac77d076f3338384a47a2ffd4bc#p62177
\makeatletter
\newcommand{\concatop}[1]{%
  \mathbin{\mathop{#1}\limits^{\vbox to 1\ex@{\kern-\tw@\ex@
   \hbox{\scriptsize$\smallfrown$}\vss}}}}
\makeatother
\makeatletter
\newcommand{\compop}[1]{%
  \mathbin{\vec{\ooalign{$\circ$\cr\hidewidth$#1$\hidewidth}}}}
\makeatother
\newcommand{\concat}{\concatop{\cdot}}
\newcommand{\fcomp}{\compop{\cdot}}
\newcommand{\balanced}[1]{#1\;\mathsf{bal}}
\newcommand{\getval}[2]{#1 \Downarrow #2}
\newcommand{\lookup}[2]{#1\;\mathsf{lookup}}
\newcommand{\subtrceq}{\superimpose[\mathrel]{\clipbox{0pt 0pt {0.3\width} 0pt}{${\subset}$}}{\hspace{0.6ex}\cdot}}
\newcommand{\rightsubtrceq}{\subtrceq_r}
\newcommand{\leftsubtrceq}{\subtrceq_l}
\newcommand{\stepm}[3]{\lceil #1 \act{#2} #3 \rceil}
\newcommand{\step}[2]{\stepm{\wild}{#1}{#2}}

%% Values
\newcommand{\Values}{\mathbb{V}}
\newcommand{\FunV}{\mathsf{fun}}
\newcommand{\ConV}{\mathsf{con}}
%% Domains
\newcommand{\Environments}{\mathbb{E}}
\newcommand{\Heaps}{\mathbb{H}}
\newcommand{\Continuations}{\mathbb{K}}
\newcommand{\Domain}[1]{{\mathbb{D}^{#1}}}
\newcommand{\PrefD}{\Domain{*}}
\newcommand{\MaxD}{\Domain{+\infty}}
\newcommand{\AbsD}{\Domain{\raisebox{0.1em}{\scalebox{0.4}{$\square$}}}}
\newcommand{\AbsCD}{\Domain{\raisebox{0.1em}{\scalebox{0.4}{c$\square$}}}}
\newcommand{\StateD}{\Domain{\States}}
\newcommand{\SSD}{\Domain{Σ}}
\newcommand{\SSCD}{\Domain{cΣ}}
\newcommand{\LiveD}{\Domain{\exists l}}
\newcommand{\LiveSD}{\Domain{sl}}
\newcommand{\LiveCD}{\Domain{cl}}
\newcommand{\LiveSCD}{\Domain{scl}}
\newcommand{\testD}{\mathbin{?\!!}}

% Math
\newcommand{\poset}[1]{\wp(#1)}
\newcommand{\Nat}{\mathbb{N}}
\DeclareMathSymbol{\bbcolon}{\mathpunct}{bbold}{"3A}
\DeclareMathSymbol{\bbquestionmark}{\mathpunct}{bbold}{"3F}
\DeclareMathSymbol{\bblparen}{\mathpunct}{bbold}{"28}
\DeclareMathSymbol{\bbrparen}{\mathpunct}{bbold}{"29}
\DeclareMathSymbol{\bbpipe}{\mathpunct}{bbold}{"7C}
\newcommand{\ternary}[3]{\bblparen\, #1 \,\mathrel{\bbquestionmark}\, #2 \,\mathrel{\bbcolon}\, #3 \,\bbrparen}

% Order theory
\DeclareMathOperator*{\lub}{\sqcup}
\DeclareMathOperator*{\Lub}{\bigsqcup}
\DeclareMathOperator*{\glb}{\sqcap}
\DeclareMathOperator*{\Glb}{\bigsqcap}
\newcommand{\lfp}{\mathsf{lfp}}
\newcommand{\gfp}{\mathsf{gfp}}

% Semantics
\newcommand{\denot}[1]{\llbracket {#1} \rrbracket}
\newcommand{\sempref}[1]{\mathcal{S}^*\denot{#1}}
\newcommand{\seminf}[1]{\mathcal{S}^{+\infty}\denot{#1}}
\newcommand{\semst}[1]{\mathcal{S}^{\States}\denot{#1}}
\newcommand{\semss}[1]{\mathcal{S}^{Σ}\denot{#1}}
\newcommand{\semlive}[1]{\mathcal{S}^{∃l}\denot{#1}}
\newcommand{\semclive}[1]{\mathcal{S}^{cl}\denot{#1}}
\newcommand{\semslive}[1]{\mathcal{S}^{sl}\denot{#1}}
\newcommand{\semsclive}[1]{\mathcal{S}^{scl}\denot{#1}}
\newcommand{\semty}[1]{\mathcal{S}^{τ}\denot{#1}}

% Stateful
\newcommand{\States}{\mathbb{S}}
\newcommand{\STraces}{\mathbb{S}^{+\infty}}
\newcommand{\sconcat}{\concatop{\hspace{0.04ex}\scalebox{0.5}{$\States$}}}
\newcommand{\sfcomp}{\compop{\scalebox{0.25}{\raisebox{0.7em}{$\States$}}}}
\newcommand{\pushF}{\cdot}
\newcommand{\StopF}{\mathbf{stop}}
\newcommand{\ReturnF}{\mathbf{ret}}
\newcommand{\ApplyF}{\mathbf{ap}}
\newcommand{\UpdateF}{\mathbf{upd}}

% Small-step
\newcommand{\Configurations}{\mathsf{Config}}
\newcommand{\Addresses}{\mathsf{Addr}}
%\newcommand{\Heaps}{\mathsf{Heap}}
\newcommand{\Envs}{\mathsf{Env}}
\newcommand{\Stacks}{\mathsf{Stack}}
\newcommand{\Frames}{\mathsf{Frame}}
\newcommand{\pH}{\mathsf{H}}
\newcommand{\pa}{\mathsf{a}}
\newcommand{\pE}{\mathsf{E}}
\newcommand{\pS}{\mathsf{S}}
\newcommand{\SSTraces}{\mathsf{SSTrace}}
\newcommand{\smallstep}{\hookrightarrow}
\newcommand{\straceend}{\scalebox{0.5}{$\square$}}
\newcommand{\ssconcat}{\concatop{\hspace{0.04ex}\scalebox{0.5}{\Sigma}}}
\newcommand{\AppIT}{\textsc{app}_1}
\newcommand{\AppET}{\textsc{app}_2}
\newcommand{\ValueT}{\textsc{val}}
\newcommand{\LookupT}{\textsc{look}}
\newcommand{\UpdateT}{\textsc{upd}}
\newcommand{\LetT}{\textsc{let}}
\newcommand{\funnyComp}{\mathop{\mathord{>}\!\mathord{\circ}\!\mathord{>}}}
\newcommand{\validtrace}[1]{#1\;\mathsf{ok\text{-}}π}
\newcommand{\maxbaltrace}[1]{#1\;\mathsf{maxbal\text{-}}π}
\newcommand{\validtracefun}[1]{#1\;\mathsf{ok\text{-}}d}

% Liveness
\newcommand{\lStacks}{\Stacks^l}
\newcommand{\lLiveness}{\mathsf{Live}}
\newcommand{\lS}{\pS^l}
\newcommand{\lSBot}{\texttt{Seq}}
\newcommand{\lSAp}[1]{\texttt{\$[$#1$]}}
\newcommand{\lSTop}{\texttt{Deep}}
\newcommand{\lAbs}{\texttt{Abs}}
\newcommand{\lUsed}[1]{\texttt{Used[$#1$]}}
\newcommand{\SVar}{\mathsf{SVar}}
\newcommand{\SCall}{\mathsf{SCall}}

% Types
\newcommand{\TyCon}{\mathsf{TyCon}}
\newcommand{\Type}{\mathsf{Type}}
\newcommand{\ArrowTy}{\Rightarrow}
